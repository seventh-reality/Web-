<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Niantic Lightship WebAR Example</title>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://lightship.dev/sdk/webar/latest.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <div id="ar-container"></div>

    <script>
        // Initialize Lightship WebAR SDK
        LightshipWebAR.create({
            clientID: 'YOUR_CLIENT_ID',  // Replace with your Lightship client ID
            container: document.getElementById('ar-container'),
            onReady: onReady
        });

        function onReady(sdk) {
            // Set up Three.js scene
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Load the .glb model
            const loader = new THREE.GLTFLoader();
            let model;
            loader.load('Steerad.glb', (gltf) => {
                model = gltf.scene;
                model.scale.set(1, 1, 1); // Adjust scale as needed
                model.visible = false; // Initially hide the model until a surface is detected
                scene.add(model);
            }, undefined, (error) => {
                console.error('An error occurred while loading the model', error);
            });

            camera.position.z = 5;

            // Animation loop
            function animate() {
                requestAnimationFrame(animate);
                if (model) {
                    model.rotation.y += 0.01; // Rotate model for visual effect
                }
                renderer.render(scene, camera);
            }
            animate();

            // Handle AR tracking and placing objects
            sdk.onFrame(({ hitTest }) => {
                if (hitTest && hitTest.length > 0) {
                    const hit = hitTest[0];
                    if (model) {
                        model.position.set(hit.position.x, hit.position.y, hit.position.z);
                        model.visible = true; // Show the model when a surface is detected
                    }
                }
            });

            // Start AR session
            sdk.start();
        }
    </script>
</body>
</html>
